<!DOCTYPE html>


<!--
 | Generated by Apache Maven Doxia Site Renderer 1.11.1 from org.apache.maven.plugins:maven-pmd-plugin:3.17.0:cpd at 2022-06-21
 | Rendered using Apache Maven Fluido Skin 1.11.0
-->
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="generator" content="Apache Maven Doxia Site Renderer 1.11.1" />
    <title>Mock Repository Manager Servlet &#x2013; CPD Results</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.11.0.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />
    <script src="./js/apache-maven-fluido-1.11.0.min.js"></script>

    <!-- Matomo -->
    <script>
        var _paq = window._paq = window._paq || [];
                _paq.push(['disableCookies']);
                    _paq.push(['trackPageView']);
                    _paq.push(['enableLinkTracking']);
        
        (function() {
            var u="https://analytics.apache.org/";
            _paq.push(['setTrackerUrl', u+'/matomo.php']);
            _paq.push(['setSiteId', '18']);
            var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
            g.async=true; g.src=u+'/matomo.js'; s.parentNode.insertBefore(g,s);
        })();
    </script>
    <!-- End Matomo Code -->
  </head>
  <body class="topBarDisabled">
    <a href="https://github.com/mojohaus/mrm">
      <img style="position: absolute; top: 0; right: 0; border: 0; z-index: 10000;"
        src="https://s3.amazonaws.com/github/ribbons/forkme_right_gray_6d6d6d.png"
        alt="Fork me on GitHub">
    </a>
    <div class="container-fluid">
      <header>
        <div id="banner">
          <div class="pull-left"><a href="../../" id="bannerLeft"><img src="../../images/mojo_logo.png"  alt="MojoHaus" style="" /></a></div>
          <div class="pull-right"></div>
          <div class="clear"><hr/></div>
        </div>

        <div id="breadcrumbs">
          <ul class="breadcrumb">
      <li class=""><a href="../../" title="MojoHaus">MojoHaus</a><span class="divider">/</span></li>
      <li class=""><a href="../../mojo-parent" title="MojoHaus Parent">MojoHaus Parent</a><span class="divider">/</span></li>
      <li class=""><a href="../index.html" title="Mock Repository Manager">Mock Repository Manager</a><span class="divider">/</span></li>
      <li class=""><a href="index.html" title="Mock Repository Manager Servlet">Mock Repository Manager Servlet</a><span class="divider">/</span></li>
    <li class="active ">CPD Results</li>
        <li id="publishDate" class="pull-right"><span class="divider">|</span> Last Published: 2022-06-21</li>
          <li id="projectVersion" class="pull-right"><span class="divider">|</span>Version: 1.4.0</li>
        <li class="pull-right"><a href="https://maven.apache.org/" class="externalLink" title="Maven">Maven</a></li>
          </ul>
        </div>
      </header>
      <div class="row-fluid">
        <header id="leftColumn" class="span2">
          <nav class="well sidebar-nav">
  <ul class="nav nav-list">
   <li class="nav-header">Parent Project</li>
    <li><a href="../index.html" title="Mock Repository Manager :: Project"><span class="none"></span>Mock Repository Manager :: Project</a></li>
   <li class="nav-header">Overview</li>
    <li><a href="index.html" title="Introduction"><span class="none"></span>Introduction</a></li>
   <li class="nav-header">Project Documentation</li>
    <li><a href="project-info.html" title="Project Information"><span class="icon-chevron-right"></span>Project Information</a></li>
    <li><a href="project-reports.html" title="Project Reports"><span class="icon-chevron-down"></span>Project Reports</a>
     <ul class="nav nav-list">
      <li><a href="checkstyle.html" title="Checkstyle"><span class="none"></span>Checkstyle</a></li>
      <li><a href="apidocs/index.html" title="Javadoc"><span class="none"></span>Javadoc</a></li>
      <li><a href="testapidocs/index.html" title="Test Javadoc"><span class="none"></span>Test Javadoc</a></li>
      <li><a href="xref/index.html" title="Source Xref"><span class="none"></span>Source Xref</a></li>
      <li><a href="xref-test/index.html" title="Test Source Xref"><span class="none"></span>Test Source Xref</a></li>
      <li class="active"><a><span class="none"></span>CPD</a></li>
      <li><a href="pmd.html" title="PMD"><span class="none"></span>PMD</a></li>
      <li><a href="surefire-report.html" title="Surefire Report"><span class="none"></span>Surefire Report</a></li>
      <li><a href="taglist.html" title="Tag List"><span class="none"></span>Tag List</a></li>
     </ul></li>
  </ul>
          </nav>
          <div class="well sidebar-nav">
            <div id="poweredBy">
              <div class="clear"></div>
              <div class="clear"></div>
              <div class="clear"></div>
<a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy"><img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" /></a>
            </div>
          </div>
        </header>
        <main id="bodyColumn"  class="span10" >
<section>
<h2><a name="CPD_Results"></a>CPD Results</h2>
<p>The following document contains the results of PMD's  <a class="externalLink" href="https://pmd.github.io/latest/pmd_userdocs_cpd.html">CPD</a> 6.46.0.</p></section><section>
<h2><a name="Duplications"></a>Duplications</h2>
<table border="0" class="table table-striped">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>org/codehaus/mojo/mrm/impl/maven/MemoryArtifactStore.java</td>
<td><a href="./xref/org/codehaus/mojo/mrm/impl/maven/MemoryArtifactStore.html#L90">90</a></td></tr>
<tr class="a">
<td>org/codehaus/mojo/mrm/impl/maven/MockArtifactStore.java</td>
<td><a href="./xref/org/codehaus/mojo/mrm/impl/maven/MockArtifactStore.html#L225">225</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>Set&lt;String&gt; result = new TreeSet&lt;&gt;();
        if ( StringUtils.isEmpty( parentGroupId ) )
        {
            for ( String groupId : contents.keySet() )
            {
                int index = groupId.indexOf( '.' );
                result.add( index == -1 ? groupId : groupId.substring( 0, index ) );
            }
        }
        else
        {
            String prefix = parentGroupId + '.';
            int start = prefix.length();
            for ( String groupId : contents.keySet() )
            {
                if ( groupId.startsWith( prefix ) )
                {
                    int index = groupId.indexOf( '.', start );
                    result.add( index == -1 ? groupId.substring( start ) : groupId.substring( start, index ) );
                }
            }
        }
        return result;
    }

    /**
     * {@inheritDoc}
     */
    public synchronized Set&lt;String&gt; getArtifactIds( String groupId )
    {
        Map&lt;String, Map&lt;String, Map&lt;Artifact, Content&gt;&gt;&gt; artifactMap = contents.get( groupId );
        return artifactMap == null ? Collections.emptySet() : new TreeSet&lt;&gt;(artifactMap.keySet() );
    }

    /**
     * {@inheritDoc}
     */
    public synchronized Set&lt;String&gt; getVersions( String groupId, String artifactId )
    {
        Map&lt;String, Map&lt;String, Map&lt;Artifact, Content&gt;&gt;&gt; artifactMap = contents.get( groupId );
        Map&lt;String, Map&lt;Artifact, Content&gt;&gt; versionMap = ( artifactMap == null ? null : artifactMap.get( artifactId ) );
        return versionMap == null ? Collections.emptySet() : new TreeSet&lt;&gt;( versionMap.keySet() );
    }

    /**
     * {@inheritDoc}
     */
    public synchronized Set&lt;Artifact&gt; getArtifacts( String groupId, String artifactId, String version )
    {
        Map&lt;String, Map&lt;String, Map&lt;Artifact, Content&gt;&gt;&gt; artifactMap = contents.get( groupId );
        Map&lt;String, Map&lt;Artifact, Content&gt;&gt; versionMap = ( artifactMap == null ? null : artifactMap.get( artifactId ) );
        Map&lt;Artifact, Content&gt; filesMap = ( versionMap == null ? null : versionMap.get( version ) );

        return filesMap == null ? Collections.emptySet() : new HashSet&lt;&gt;( filesMap.keySet() );
    }

    /**
     * {@inheritDoc}
     */
    public synchronized long getLastModified( Artifact artifact )
        throws IOException, ArtifactNotFoundException
    {
        Map&lt;String, Map&lt;String, Map&lt;Artifact, Content&gt;&gt;&gt; artifactMap = contents.get( artifact.getGroupId() );
        Map&lt;String, Map&lt;Artifact, Content&gt;&gt; versionMap = ( artifactMap == null ? null : artifactMap.get( artifact.getArtifactId() ) );
        Map&lt;Artifact, Content&gt; filesMap = ( versionMap == null ? null : versionMap.get( artifact.getVersion() ) );
        Content content = ( filesMap == null ? null : filesMap.get( artifact ) );
        if ( content == null )
        {
            if ( artifact.isSnapshot() &amp;&amp; artifact.getTimestamp() == null &amp;&amp; filesMap != null )
            {
                Artifact best = null;
                for ( Map.Entry&lt;Artifact, Content&gt; entry : filesMap.entrySet() )
                {
                    Artifact a = entry.getKey();
                    if ( artifact.equalSnapshots( a ) &amp;&amp; ( best == null || best.compareTo( a ) &lt; 0 ) )
                    {
                        best = a;
                        content = entry.getValue();
                    }
                }
                if ( content == null )
                {
                    throw new ArtifactNotFoundException( artifact );

                }
            }
            else
            {
                throw new ArtifactNotFoundException( artifact );
            }
        }
        return content.getLastModified();
    }

    /**
     * {@inheritDoc}
     */
    public synchronized long getSize( Artifact artifact )
        throws IOException, ArtifactNotFoundException
    {
        Map&lt;String, Map&lt;String, Map&lt;Artifact, Content&gt;&gt;&gt; artifactMap = contents.get( artifact.getGroupId() );
        Map&lt;String, Map&lt;Artifact, Content&gt;&gt; versionMap = ( artifactMap == null ? null : artifactMap.get( artifact.getArtifactId() ) );
        Map&lt;Artifact, Content&gt; filesMap = ( versionMap == null ? null : versionMap.get( artifact.getVersion() ) );
        Content content = ( filesMap == null ? null : filesMap.get( artifact ) );
        if ( content == null )
        {
            if ( artifact.isSnapshot() &amp;&amp; artifact.getTimestamp() == null &amp;&amp; filesMap != null )
            {
                Artifact best = null;
                for ( Map.Entry&lt;Artifact, Content&gt; entry : filesMap.entrySet() )
                {
                    Artifact a = entry.getKey();
                    if ( artifact.equalSnapshots( a ) &amp;&amp; ( best == null || best.compareTo( a ) &lt; 0 ) )
                    {
                        best = a;
                        content = entry.getValue();
                    }
                }
                if ( content == null )
                {
                    throw new ArtifactNotFoundException( artifact );

                }
            }
            else
            {
                throw new ArtifactNotFoundException( artifact );
            }
        }
        return content.getBytes().length;</pre></div></td></tr></table>
<table border="0" class="table table-striped">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>org/codehaus/mojo/mrm/impl/maven/MemoryArtifactStore.java</td>
<td><a href="./xref/org/codehaus/mojo/mrm/impl/maven/MemoryArtifactStore.html#L421">421</a></td></tr>
<tr class="a">
<td>org/codehaus/mojo/mrm/impl/maven/MockArtifactStore.java</td>
<td><a href="./xref/org/codehaus/mojo/mrm/impl/maven/MockArtifactStore.html#L565">565</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>Content content = entry.getValue();
                    SimpleDateFormat fmt = new SimpleDateFormat( &quot;yyyyMMddHHmmss&quot; );
                    fmt.setTimeZone( TimeZone.getTimeZone( &quot;GMT&quot; ) );
                    String lastUpdatedTime = fmt.format( new Date( content.getLastModified() ) );
                    try
                    {
                        Maven3.addSnapshotVersion( snapshotVersions, artifact, lastUpdatedTime );
                    }
                    catch ( LinkageError e )
                    {
                        // Maven 2
                    }
                    if ( &quot;pom&quot;.equals( artifact.getType() ) )
                    {
                        if ( artifact.getBuildNumber() != null
                            &amp;&amp; maxBuildNumber &lt; artifact.getBuildNumber())
                        {
                            maxBuildNumber = artifact.getBuildNumber();
                            timestamp = artifact.getTimestampString();
                        }
                        else
                        {
                            maxBuildNumber = Math.max( 1, maxBuildNumber );
                        }
                        lastUpdated = Math.max( lastUpdated, content.getLastModified() );
                        found = true;
                    }
                }

                if ( !snapshotVersions.isEmpty() || found )
                {
                    Versioning versioning = metadata.getVersioning();
                    if ( versioning == null )
                    {
                        versioning = new Versioning();
                    }
                    metadata.setGroupId( groupId );
                    metadata.setArtifactId( artifactId );
                    metadata.setVersion( version );
                    try
                    {
                        Maven3.addSnapshotVersions( versioning, snapshotVersions );
                    }
                    catch ( LinkageError e )
                    {
                        // Maven 2
                    }
                    if ( maxBuildNumber &gt; 0 )
                    {
                        Snapshot snapshot = new Snapshot();
                        snapshot.setBuildNumber( maxBuildNumber );
                        snapshot.setTimestamp( timestamp );
                        versioning.setSnapshot( snapshot );
                    }
                    versioning.setLastUpdatedTimestamp( new Date( lastUpdated ) );
                    metadata.setVersioning( versioning );
                    foundMetadata = true;
                }
            }

        }
        if ( !foundMetadata )
        {
            throw new MetadataNotFoundException( path );
        }
        return metadata;
    }

    /**
     * {@inheritDoc}
     */
    public synchronized long getMetadataLastModified( String path )
        throws IOException, MetadataNotFoundException
    {
        boolean haveResult = false;
        long result = 0;
        path = StringUtils.stripEnd( StringUtils.stripStart( path, &quot;/&quot; ), &quot;/&quot; );
        String groupId = path.replace( '/', '.' );
        Map&lt;String, Map&lt;String, Map&lt;Artifact, Content&gt;&gt;&gt; artifactMap = contents.get( groupId );
        if ( artifactMap != null )
        {
            for ( Map&lt;String, Map&lt;Artifact, Content&gt;&gt; versionMap : artifactMap.values() )
            {
                for ( Map&lt;Artifact, Content&gt; filesMap : versionMap.values() )
                {
                    for ( Content content : filesMap.values() )
                    {
                        haveResult = true;
                        result = Math.max( result, content.getLastModified() );
                    }
                }
            }
        }
        int index = path.lastIndexOf( '/' );
        groupId = index == -1 ? groupId : groupId.substring( 0, index ).replace( '/', '.' );
        String artifactId = ( index == -1 ? null : path.substring( index + 1 ) );
        if ( artifactId != null )
        {
            artifactMap = contents.get( groupId );
            Map&lt;String, Map&lt;Artifact, Content&gt;&gt; versionMap = ( artifactMap == null ? null : artifactMap.get( artifactId ) );
            if ( versionMap != null )
            {
                for ( Map&lt;Artifact, Content&gt; filesMap : versionMap.values() )
                {
                    for ( Content content : filesMap.values() )
                    {
                        haveResult = true;
                        result = Math.max( result, content.getLastModified() );
                    }
                }
            }
        }
        int index2 = index == -1 ? -1 : path.lastIndexOf( '/', index - 1 );
        groupId = index2 == -1 ? groupId : groupId.substring( 0, index2 ).replace( '/', '.' );
        artifactId = index2 == -1 ? artifactId : path.substring( index2 + 1, index );
        String version = index2 == -1 ? null : path.substring( index + 1 );
        if ( version != null &amp;&amp; version.endsWith( &quot;-SNAPSHOT&quot; ) )
        {
            artifactMap = contents.get( groupId );
            Map&lt;String, Map&lt;Artifact, Content&gt;&gt; versionMap = ( artifactMap == null ? null : artifactMap.get( artifactId ) );
            Map&lt;Artifact, Content&gt; filesMap = ( versionMap == null ? null : versionMap.get( version ) );
            if ( filesMap != null )
            {
                for ( Content content : filesMap.values() )
                {
                    haveResult = true;
                    result = Math.max( result, content.getLastModified() );
                }
            }
        }
        if ( haveResult )
        {
            return result;
        }
        throw new MetadataNotFoundException( path );
    }</pre></div></td></tr></table>
<table border="0" class="table table-striped">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>org/codehaus/mojo/mrm/impl/maven/MemoryArtifactStore.java</td>
<td><a href="./xref/org/codehaus/mojo/mrm/impl/maven/MemoryArtifactStore.html#L308">308</a></td></tr>
<tr class="a">
<td>org/codehaus/mojo/mrm/impl/maven/MockArtifactStore.java</td>
<td><a href="./xref/org/codehaus/mojo/mrm/impl/maven/MockArtifactStore.html#L452">452</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>Model model = reader.read(xmlStreamReader);
                        if ( model == null || !&quot;maven-plugin&quot;.equals( model.getPackaging() ) )
                        {
                            continue;
                        }
                        Plugin plugin = new Plugin();
                        plugin.setArtifactId( artifactId );
                        plugin.setName( model.getName() );
                        // TODO proper goal-prefix determination
                        // ugh! this is incredibly hacky and does not handle some fool that sets the goal prefix in
                        // a parent pom... ok unlikely, but stupid is as stupid does
                        boolean havePrefix = false;
                        final Build build = model.getBuild();
                        if ( build != null &amp;&amp; build.getPlugins() != null )
                        {
                            havePrefix = setPluginGoalPrefixFromConfiguration( plugin, build.getPlugins() );
                        }
                        if ( !havePrefix &amp;&amp; build != null &amp;&amp; build.getPluginManagement() != null
                            &amp;&amp; build.getPluginManagement().getPlugins() != null )
                        {
                            havePrefix = setPluginGoalPrefixFromConfiguration( plugin,
                                                                               build.getPluginManagement().getPlugins() );
                        }
                        if ( !havePrefix &amp;&amp; artifactId.startsWith( &quot;maven-&quot; ) &amp;&amp; artifactId.endsWith( &quot;-plugin&quot; ) )
                        {
                            plugin.setPrefix(
                                StringUtils.removeStart( StringUtils.removeEnd( artifactId, &quot;-plugin&quot; ), &quot;maven-&quot; ) );
                            havePrefix = true;
                        }
                        if ( !havePrefix &amp;&amp; artifactId.endsWith( &quot;-maven-plugin&quot; ) )
                        {
                            plugin.setPrefix( StringUtils.removeEnd( artifactId, &quot;-maven-plugin&quot; ) );
                            havePrefix = true;
                        }
                        if ( !havePrefix )
                        {
                            plugin.setPrefix( artifactId );
                        }
                        plugins.add( plugin );
                        foundMetadata = true;
                        break;
                    }
                    catch ( ArtifactNotFoundException | XmlPullParserException e )
                    {
                        // ignore
                    }
                }
            }
            if ( !plugins.isEmpty() )
            {
                metadata.setPlugins( plugins );
            }
        }
        int index = path.lastIndexOf( '/' );
        groupId = ( index == -1 ? groupId : groupId.substring( 0, index ) ).replace( '/', '.' );
        String artifactId = ( index == -1 ? null : path.substring( index + 1 ) );
        if ( artifactId != null )
        {
            Set&lt;String&gt; artifactVersions = getVersions( groupId, artifactId );
            if ( artifactVersions != null &amp;&amp; !artifactVersions.isEmpty() )
            {
                metadata.setGroupId( groupId );
                metadata.setArtifactId( artifactId );
                Versioning versioning = new Versioning();
                List&lt;String&gt; versions = new ArrayList&lt;&gt;( artifactVersions );
                versions.sort(INSTANCE); // sort the Maven way
                long lastUpdated = 0;
                for ( String version : versions )
                {
                    try
                    {
                        long lastModified = getLastModified( new Artifact( groupId, artifactId, version, &quot;pom&quot; ) );
                        versioning.addVersion( version );
                        if ( lastModified &gt;= lastUpdated )
                        {
                            lastUpdated = lastModified;
                            versioning.setLastUpdatedTimestamp( new Date( lastModified ) );
                            versioning.setLatest( version );
                            if ( !version.endsWith( &quot;-SNAPSHOT&quot; ) )
                            {
                                versioning.setRelease( version );
                            }
                        }
                    }
                    catch ( ArtifactNotFoundException e )
                    {
                        // ignore
                    }
                }
                metadata.setVersioning( versioning );
                foundMetadata = true;
            }
        }

        int index2 = index == -1 ? -1 : path.lastIndexOf( '/', index - 1 );
        groupId = index2 == -1 ? groupId : groupId.substring( 0, index2 ).replace( '/', '.' );
        artifactId = index2 == -1 ? artifactId : path.substring( index2 + 1, index );
        String version = index2 == -1 ? null : path.substring( index + 1 );
        if ( version != null &amp;&amp; version.endsWith( &quot;-SNAPSHOT&quot; ) )
        {
            Map&lt;String, Map&lt;String, Map&lt;Artifact, Content&gt;&gt;&gt; artifactMap = contents.get( groupId );
            Map&lt;String, Map&lt;Artifact, Content&gt;&gt; versionMap = ( artifactMap == null ? null : artifactMap.get( artifactId ) );
            Map&lt;Artifact, Content&gt; filesMap = ( versionMap == null ? null : versionMap.get( version ) );
            if ( filesMap != null )
            {
                List&lt;SnapshotVersion&gt; snapshotVersions = new ArrayList&lt;&gt;();
                int maxBuildNumber = 0;
                long lastUpdated = 0;
                String timestamp = null;
                boolean found = false;
                for ( Map.Entry&lt;Artifact, Content&gt; entry : filesMap.entrySet() )</pre></div></td></tr></table>
<table border="0" class="table table-striped">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>org/codehaus/mojo/mrm/impl/maven/DiskArtifactStore.java</td>
<td><a href="./xref/org/codehaus/mojo/mrm/impl/maven/DiskArtifactStore.html#L180">180</a></td></tr>
<tr class="a">
<td>org/codehaus/mojo/mrm/impl/maven/FileSystemArtifactStore.java</td>
<td><a href="./xref/org/codehaus/mojo/mrm/impl/maven/FileSystemArtifactStore.html#L155">155</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>Matcher matcher = rule.matcher( file.getName() );
                    if ( !matcher.matches() )
                    {
                        return null;
                    }
                    if ( matcher.group( 1 ).equals( &quot;SNAPSHOT&quot; ) )
                    {
                        return new Artifact( groupId, artifactId, version, matcher.group( 9 ), matcher.group( 10 ) );
                    }
                    try
                    {
                        Calendar cal = new GregorianCalendar();
                        cal.setTimeZone( TimeZone.getTimeZone( &quot;GMT&quot; ) );
                        cal.set( Calendar.YEAR, Integer.parseInt( matcher.group( 2 ) ) );
                        cal.set( Calendar.MONTH, Integer.parseInt( matcher.group( 3 ) ) - 1 );
                        cal.set( Calendar.DAY_OF_MONTH, Integer.parseInt( matcher.group( 4 ) ) );
                        cal.set( Calendar.HOUR_OF_DAY, Integer.parseInt( matcher.group( 5 ) ) );
                        cal.set( Calendar.MINUTE, Integer.parseInt( matcher.group( 6 ) ) );
                        cal.set( Calendar.SECOND, Integer.parseInt( matcher.group( 7 ) ) );
                        long timestamp = cal.getTimeInMillis();
                        int buildNumber = Integer.parseInt( matcher.group( 8 ) );
                        return new Artifact( groupId, artifactId, version, matcher.group( 9 ), matcher.group( 10 ),
                                             timestamp, buildNumber );
                    }
                    catch ( NullPointerException e )
                    {
                        return null;
                    }
                }
            };
        }
        else
        {
            rule = Pattern.compile( &quot;\\Q&quot; + artifactId + &quot;\\E-\\Q&quot; + version + &quot;\\E(?:-([^.]+))?\\.(.+)&quot; );
            factory = new ArtifactFactory()
            {
                public Artifact get( File file )</pre></div></td></tr></table>
<table border="0" class="table table-striped">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>org/codehaus/mojo/mrm/impl/maven/MemoryArtifactStore.java</td>
<td><a href="./xref/org/codehaus/mojo/mrm/impl/maven/MemoryArtifactStore.html#L220">220</a></td></tr>
<tr class="a">
<td>org/codehaus/mojo/mrm/impl/maven/MockArtifactStore.java</td>
<td><a href="./xref/org/codehaus/mojo/mrm/impl/maven/MockArtifactStore.html#L353">353</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>}

    /**
     * {@inheritDoc}
     */
    public synchronized InputStream get( Artifact artifact )
        throws IOException, ArtifactNotFoundException
    {
        Map&lt;String, Map&lt;String, Map&lt;Artifact, Content&gt;&gt;&gt; artifactMap = contents.get( artifact.getGroupId() );
        Map&lt;String, Map&lt;Artifact, Content&gt;&gt; versionMap = ( artifactMap == null ? null : artifactMap.get( artifact.getArtifactId() ) );
        Map&lt;Artifact, Content&gt; filesMap = ( versionMap == null ? null : versionMap.get( artifact.getVersion() ) );
        Content content = ( filesMap == null ? null : filesMap.get( artifact ) );
        if ( content == null )
        {
            if ( artifact.isSnapshot() &amp;&amp; artifact.getTimestamp() == null &amp;&amp; filesMap != null )
            {
                Artifact best = null;
                for ( Map.Entry&lt;Artifact, Content&gt; entry : filesMap.entrySet() )
                {
                    Artifact a = entry.getKey();
                    if ( artifact.equalSnapshots( a ) &amp;&amp; ( best == null || best.compareTo( a ) &lt; 0 ) )
                    {
                        best = a;
                        content = entry.getValue();
                    }
                }
                if ( content == null )
                {
                    throw new ArtifactNotFoundException( artifact );

                }
            }
            else
            {
                throw new ArtifactNotFoundException( artifact );
            }
        }
        return new ByteArrayInputStream( content.getBytes() );</pre></div></td></tr></table>
<table border="0" class="table table-striped">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>org/codehaus/mojo/mrm/impl/maven/MemoryArtifactStore.java</td>
<td><a href="./xref/org/codehaus/mojo/mrm/impl/maven/MemoryArtifactStore.html#L149">149</a></td></tr>
<tr class="a">
<td>org/codehaus/mojo/mrm/impl/maven/MemoryArtifactStore.java</td>
<td><a href="./xref/org/codehaus/mojo/mrm/impl/maven/MemoryArtifactStore.html#L187">187</a></td></tr>
<tr class="b">
<td>org/codehaus/mojo/mrm/impl/maven/MockArtifactStore.java</td>
<td><a href="./xref/org/codehaus/mojo/mrm/impl/maven/MockArtifactStore.html#L284">284</a></td></tr>
<tr class="a">
<td>org/codehaus/mojo/mrm/impl/maven/MockArtifactStore.java</td>
<td><a href="./xref/org/codehaus/mojo/mrm/impl/maven/MockArtifactStore.html#L321">321</a></td></tr>
<tr class="b">
<td>org/codehaus/mojo/mrm/impl/maven/MockArtifactStore.java</td>
<td><a href="./xref/org/codehaus/mojo/mrm/impl/maven/MockArtifactStore.html#L358">358</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>public synchronized long getLastModified( Artifact artifact )
        throws IOException, ArtifactNotFoundException
    {
        Map&lt;String, Map&lt;String, Map&lt;Artifact, Content&gt;&gt;&gt; artifactMap = contents.get( artifact.getGroupId() );
        Map&lt;String, Map&lt;Artifact, Content&gt;&gt; versionMap = ( artifactMap == null ? null : artifactMap.get( artifact.getArtifactId() ) );
        Map&lt;Artifact, Content&gt; filesMap = ( versionMap == null ? null : versionMap.get( artifact.getVersion() ) );
        Content content = ( filesMap == null ? null : filesMap.get( artifact ) );
        if ( content == null )
        {
            if ( artifact.isSnapshot() &amp;&amp; artifact.getTimestamp() == null &amp;&amp; filesMap != null )
            {
                Artifact best = null;
                for ( Map.Entry&lt;Artifact, Content&gt; entry : filesMap.entrySet() )
                {
                    Artifact a = entry.getKey();
                    if ( artifact.equalSnapshots( a ) &amp;&amp; ( best == null || best.compareTo( a ) &lt; 0 ) )
                    {
                        best = a;
                        content = entry.getValue();
                    }
                }
                if ( content == null )
                {
                    throw new ArtifactNotFoundException( artifact );

                }
            }
            else
            {
                throw new ArtifactNotFoundException( artifact );
            }
        }
        return content.getLastModified();</pre></div></td></tr></table>
<table border="0" class="table table-striped">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>org/codehaus/mojo/mrm/impl/maven/MemoryArtifactStore.java</td>
<td><a href="./xref/org/codehaus/mojo/mrm/impl/maven/MemoryArtifactStore.html#L149">149</a></td></tr>
<tr class="b">
<td>org/codehaus/mojo/mrm/impl/maven/MemoryArtifactStore.java</td>
<td><a href="./xref/org/codehaus/mojo/mrm/impl/maven/MemoryArtifactStore.html#L187">187</a></td></tr>
<tr class="a">
<td>org/codehaus/mojo/mrm/impl/maven/MemoryArtifactStore.java</td>
<td><a href="./xref/org/codehaus/mojo/mrm/impl/maven/MemoryArtifactStore.html#L225">225</a></td></tr>
<tr class="b">
<td>org/codehaus/mojo/mrm/impl/maven/MockArtifactStore.java</td>
<td><a href="./xref/org/codehaus/mojo/mrm/impl/maven/MockArtifactStore.html#L284">284</a></td></tr>
<tr class="a">
<td>org/codehaus/mojo/mrm/impl/maven/MockArtifactStore.java</td>
<td><a href="./xref/org/codehaus/mojo/mrm/impl/maven/MockArtifactStore.html#L321">321</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>public synchronized long getLastModified( Artifact artifact )
        throws IOException, ArtifactNotFoundException
    {
        Map&lt;String, Map&lt;String, Map&lt;Artifact, Content&gt;&gt;&gt; artifactMap = contents.get( artifact.getGroupId() );
        Map&lt;String, Map&lt;Artifact, Content&gt;&gt; versionMap = ( artifactMap == null ? null : artifactMap.get( artifact.getArtifactId() ) );
        Map&lt;Artifact, Content&gt; filesMap = ( versionMap == null ? null : versionMap.get( artifact.getVersion() ) );
        Content content = ( filesMap == null ? null : filesMap.get( artifact ) );
        if ( content == null )
        {
            if ( artifact.isSnapshot() &amp;&amp; artifact.getTimestamp() == null &amp;&amp; filesMap != null )
            {
                Artifact best = null;
                for ( Map.Entry&lt;Artifact, Content&gt; entry : filesMap.entrySet() )
                {
                    Artifact a = entry.getKey();
                    if ( artifact.equalSnapshots( a ) &amp;&amp; ( best == null || best.compareTo( a ) &lt; 0 ) )
                    {
                        best = a;
                        content = entry.getValue();
                    }
                }
                if ( content == null )
                {
                    throw new ArtifactNotFoundException( artifact );

                }
            }
            else
            {
                throw new ArtifactNotFoundException( artifact );
            }
        }
        return content.getLastModified();</pre></div></td></tr></table>
<table border="0" class="table table-striped">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>org/codehaus/mojo/mrm/impl/maven/MemoryArtifactStore.java</td>
<td><a href="./xref/org/codehaus/mojo/mrm/impl/maven/MemoryArtifactStore.html#L585">585</a></td></tr>
<tr class="a">
<td>org/codehaus/mojo/mrm/impl/maven/MockArtifactStore.java</td>
<td><a href="./xref/org/codehaus/mojo/mrm/impl/maven/MockArtifactStore.html#L732">732</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>public synchronized long getArchetypeCatalogLastModified()
        throws ArchetypeCatalogNotFoundException
    {
        if ( archetypeCatalog != null )
        {
            return archetypeCatalog.getLastModified();
        }
        else
        {
            throw new ArchetypeCatalogNotFoundException();
        }
    }
    

    /**
     * If the plugin configurations contain a reference to the &lt;code&gt;maven-plugin-plugin&lt;/code&gt; and that contains
     * configuration of the &lt;code&gt;goalPrefix&lt;/code&gt;, update the supplied plugin with that prefix.
     *
     * @param plugin        the plugin to update.
     * @param pluginConfigs the configurations of {@link org.apache.maven.model.Plugin} to search.
     * @return &lt;code&gt;true&lt;/code&gt; if the prefix has been set.
     * @since 1.0
     */
    private boolean setPluginGoalPrefixFromConfiguration( Plugin plugin, List&lt;org.apache.maven.model.Plugin&gt; pluginConfigs )
    {
        for ( org.apache.maven.model.Plugin def : pluginConfigs )
        {
            if ( ( def.getGroupId() == null || StringUtils.equals( &quot;org.apache.maven.plugins&quot;, def.getGroupId() ) )
                &amp;&amp; StringUtils.equals( &quot;maven-plugin-plugin&quot;, def.getArtifactId() ) )
            {
                Xpp3Dom configuration = (Xpp3Dom) def.getConfiguration();
                if ( configuration != null )
                {
                    final Xpp3Dom goalPrefix = configuration.getChild( &quot;goalPrefix&quot; );
                    if ( goalPrefix != null )
                    {
                        plugin.setPrefix( goalPrefix.getValue() );
                        return true;
                    }
                }
                break;
            }
        }
        return false;
    }

    private static final Comparator&lt;String&gt; INSTANCE = new VersionComparator();

    /**
     * Compares two versions using Maven's version comparison rules.
     *
     * @since 1.0
     */
    private static class VersionComparator
        implements Comparator&lt;String&gt;
    {</pre></div></td></tr></table>
<table border="0" class="table table-striped">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>org/codehaus/mojo/mrm/impl/maven/ArtifactStoreFileSystem.java</td>
<td><a href="./xref/org/codehaus/mojo/mrm/impl/maven/ArtifactStoreFileSystem.html#L460">460</a></td></tr>
<tr class="a">
<td>org/codehaus/mojo/mrm/impl/maven/DiskArtifactStore.java</td>
<td><a href="./xref/org/codehaus/mojo/mrm/impl/maven/DiskArtifactStore.html#L184">184</a></td></tr>
<tr class="b">
<td>org/codehaus/mojo/mrm/impl/maven/FileSystemArtifactStore.java</td>
<td><a href="./xref/org/codehaus/mojo/mrm/impl/maven/FileSystemArtifactStore.html#L159">159</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>}
            if ( matcher.group( 1 ).equals( &quot;SNAPSHOT&quot; ) )
            {
                return new Artifact( groupId, artifactId, version, matcher.group( 9 ),
                                                  matcher.group( 10 ) );
            }
            try
            {
                Calendar cal = new GregorianCalendar();
                cal.setTimeZone( TimeZone.getTimeZone( &quot;GMT&quot; ) );
                cal.set( Calendar.YEAR, Integer.parseInt( matcher.group( 2 ) ) );
                cal.set( Calendar.MONTH, Integer.parseInt( matcher.group( 3 ) ) - 1 );
                cal.set( Calendar.DAY_OF_MONTH, Integer.parseInt( matcher.group( 4 ) ) );
                cal.set( Calendar.HOUR_OF_DAY, Integer.parseInt( matcher.group( 5 ) ) );
                cal.set( Calendar.MINUTE, Integer.parseInt( matcher.group( 6 ) ) );
                cal.set( Calendar.SECOND, Integer.parseInt( matcher.group( 7 ) ) );</pre></div></td></tr></table>
<table border="0" class="table table-striped">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>org/codehaus/mojo/mrm/impl/maven/ArtifactStoreFileSystem.java</td>
<td><a href="./xref/org/codehaus/mojo/mrm/impl/maven/ArtifactStoreFileSystem.html#L305">305</a></td></tr>
<tr class="b">
<td>org/codehaus/mojo/mrm/impl/maven/ArtifactStoreFileSystem.java</td>
<td><a href="./xref/org/codehaus/mojo/mrm/impl/maven/ArtifactStoreFileSystem.html#L465">465</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>}
                try
                {
                    Calendar cal = new GregorianCalendar();
                    cal.setTimeZone( TimeZone.getTimeZone( &quot;GMT&quot; ) );
                    cal.set( Calendar.YEAR, Integer.parseInt( matcher.group( 2 ) ) );
                    cal.set( Calendar.MONTH, Integer.parseInt( matcher.group( 3 ) ) - 1 );
                    cal.set( Calendar.DAY_OF_MONTH, Integer.parseInt( matcher.group( 4 ) ) );
                    cal.set( Calendar.HOUR_OF_DAY, Integer.parseInt( matcher.group( 5 ) ) );
                    cal.set( Calendar.MINUTE, Integer.parseInt( matcher.group( 6 ) ) );
                    cal.set( Calendar.SECOND, Integer.parseInt( matcher.group( 7 ) ) );
                    cal.set( Calendar.MILLISECOND, 0);
                    long timestamp = cal.getTimeInMillis();
                    int buildNumber = Integer.parseInt( matcher.group( 8 ) );</pre></div></td></tr></table>
<table border="0" class="table table-striped">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>org/codehaus/mojo/mrm/impl/maven/ArtifactStoreFileSystem.java</td>
<td><a href="./xref/org/codehaus/mojo/mrm/impl/maven/ArtifactStoreFileSystem.html#L265">265</a></td></tr>
<tr class="b">
<td>org/codehaus/mojo/mrm/impl/maven/ArtifactStoreFileSystem.java</td>
<td><a href="./xref/org/codehaus/mojo/mrm/impl/maven/ArtifactStoreFileSystem.html#L437">437</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>Matcher snapshotArtifact = SNAPSHOT_ARTIFACT.matcher( path );
            if ( snapshotArtifact.matches() )
            {
                String groupId = StringUtils.stripEnd( snapshotArtifact.group( 1 ), &quot;/&quot; ).replace( '/', '.' );
                String artifactId = snapshotArtifact.group( 2 );
                String version = snapshotArtifact.group( 3 ) + &quot;-SNAPSHOT&quot;;
                Pattern rule = Pattern.compile(
                    &quot;\\Q&quot; + artifactId + &quot;\\E-(?:\\Q&quot; + StringUtils.removeEnd( version, &quot;-SNAPSHOT&quot; )
                        + &quot;\\E-(SNAPSHOT|(\\d{4})(\\d{2})(\\d{2})\\.(\\d{2})(\\d{2})(\\d{2})-(\\d+)))(?:-([^.]+))?\\.([^/]*)&quot; );
                Matcher matcher = rule.matcher( name );
                if ( !matcher.matches() )
                {
                    String classifier = snapshotArtifact.group( 5 );
                    String type = snapshotArtifact.group( 6 );
                    if ( classifier != null )
                    {
                        classifier = classifier.substring( 1 );
                    }
                    if ( StringUtils.isEmpty( classifier ) )
                    {
                        classifier = null;
                    }
                    return new ArtifactFileEntry( this, parent,</pre></div></td></tr></table>
<table border="0" class="table table-striped">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>org/codehaus/mojo/mrm/impl/maven/ArtifactStoreFileSystem.java</td>
<td><a href="./xref/org/codehaus/mojo/mrm/impl/maven/ArtifactStoreFileSystem.html#L305">305</a></td></tr>
<tr class="b">
<td>org/codehaus/mojo/mrm/impl/maven/DiskArtifactStore.java</td>
<td><a href="./xref/org/codehaus/mojo/mrm/impl/maven/DiskArtifactStore.html#L188">188</a></td></tr>
<tr class="a">
<td>org/codehaus/mojo/mrm/impl/maven/FileSystemArtifactStore.java</td>
<td><a href="./xref/org/codehaus/mojo/mrm/impl/maven/FileSystemArtifactStore.html#L163">163</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>}
                try
                {
                    Calendar cal = new GregorianCalendar();
                    cal.setTimeZone( TimeZone.getTimeZone( &quot;GMT&quot; ) );
                    cal.set( Calendar.YEAR, Integer.parseInt( matcher.group( 2 ) ) );
                    cal.set( Calendar.MONTH, Integer.parseInt( matcher.group( 3 ) ) - 1 );
                    cal.set( Calendar.DAY_OF_MONTH, Integer.parseInt( matcher.group( 4 ) ) );
                    cal.set( Calendar.HOUR_OF_DAY, Integer.parseInt( matcher.group( 5 ) ) );
                    cal.set( Calendar.MINUTE, Integer.parseInt( matcher.group( 6 ) ) );
                    cal.set( Calendar.SECOND, Integer.parseInt( matcher.group( 7 ) ) );</pre></div></td></tr></table>
<table border="0" class="table table-striped">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>org/codehaus/mojo/mrm/impl/maven/MemoryArtifactStore.java</td>
<td><a href="./xref/org/codehaus/mojo/mrm/impl/maven/MemoryArtifactStore.html#L277">277</a></td></tr>
<tr class="a">
<td>org/codehaus/mojo/mrm/impl/maven/MockArtifactStore.java</td>
<td><a href="./xref/org/codehaus/mojo/mrm/impl/maven/MockArtifactStore.html#L423">423</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>}

    /**
     * {@inheritDoc}
     */
    public synchronized Metadata getMetadata( String path )
        throws IOException, MetadataNotFoundException
    {
        Metadata metadata = new Metadata();
        boolean foundMetadata = false;
        path = StringUtils.stripEnd( StringUtils.stripStart( path, &quot;/&quot; ), &quot;/&quot; );
        String groupId = path.replace( '/', '.' );
        Set&lt;String&gt; pluginArtifactIds = getArtifactIds( groupId );
        if ( pluginArtifactIds != null )
        {
            List&lt;Plugin&gt; plugins = new ArrayList&lt;&gt;();
            for ( String artifactId : pluginArtifactIds )
            {
                Set&lt;String&gt; pluginVersions = getVersions( groupId, artifactId );
                if ( pluginVersions == null || pluginVersions.isEmpty() )
                {
                    continue;
                }
                String[] versions = pluginVersions.toArray(new String[0]);
                Arrays.sort( versions, INSTANCE );</pre></div></td></tr></table>
<table border="0" class="table table-striped">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>org/codehaus/mojo/mrm/impl/maven/MemoryArtifactStore.java</td>
<td><a href="./xref/org/codehaus/mojo/mrm/impl/maven/MemoryArtifactStore.html#L714">714</a></td></tr>
<tr class="a">
<td>org/codehaus/mojo/mrm/impl/maven/MockArtifactStore.java</td>
<td><a href="./xref/org/codehaus/mojo/mrm/impl/maven/MockArtifactStore.html#L1001">1001</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>}
    }

    /**
     * In order to allow the use of Maven 3 methods from a plugin running in Maven 2, we need to encapsulate all the
     * Maven 3 method signatures in a separate class so that we can catch the {@link LinkageError} that will be thrown
     * when the class is attempted to load. If we didn't do it this way then our class could not load either.
     *
     * @since 1.0
     */
    private static class Maven3
    {
        /**
         * Adds a snapshot version to the list of snapshot versions.
         *
         * @param snapshotVersions the list of snapshot versions.
         * @param artifact         the artifact to add details of.
         * @param lastUpdatedTime  the time to flag for last updated.
         * @since 1.0
         */
        private static void addSnapshotVersion( List&lt;SnapshotVersion&gt; snapshotVersions, Artifact artifact, String lastUpdatedTime )
        {
            try
            {
                SnapshotVersion snapshotVersion = new SnapshotVersion();
                snapshotVersion.setExtension( artifact.getType() );
                snapshotVersion.setClassifier( artifact.getClassifier() == null ? &quot;&quot; : artifact.getClassifier() );
                snapshotVersion.setVersion( artifact.getTimestampVersion() );
                snapshotVersion.setUpdated( lastUpdatedTime );
                snapshotVersions.add( snapshotVersion );
            }
            catch ( NoClassDefFoundError e )
            {
                // Maven 2
            }
        }

        /**
         * Add the list of {@link SnapshotVersion}s to the {@link Versioning}.
         *
         * @param versioning       the versionioning to add to.
         * @param snapshotVersions the snapshot versions to add.
         * @since 1.0
         */
        private static void addSnapshotVersions( Versioning versioning, List&lt;SnapshotVersion&gt; snapshotVersions )
        {
            try
            {
                for ( SnapshotVersion snapshotVersion : snapshotVersions )
                {
                    versioning.addSnapshotVersion( snapshotVersion );
                }
            }
            catch ( NoClassDefFoundError e )
            {
                // Maven 2
            }
        }
    }
}</pre></div></td></tr></table>
<table border="0" class="table table-striped">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>org/codehaus/mojo/mrm/impl/maven/ArtifactStoreFileSystem.java</td>
<td><a href="./xref/org/codehaus/mojo/mrm/impl/maven/ArtifactStoreFileSystem.html#L336">336</a></td></tr>
<tr class="a">
<td>org/codehaus/mojo/mrm/impl/maven/ArtifactStoreFileSystem.java</td>
<td><a href="./xref/org/codehaus/mojo/mrm/impl/maven/ArtifactStoreFileSystem.html#L486">486</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>}
            }
            else
            {
                Matcher matcher = ARTIFACT.matcher( path );
                if ( matcher.matches() )
                {
                    String groupId = StringUtils.stripEnd( matcher.group( 1 ), &quot;/&quot; ).replace( '/', '.' );
                    String artifactId = matcher.group( 2 );
                    String version = matcher.group( 3 );
                    String classifier = matcher.group( 5 );
                    String type = matcher.group( 6 );
                    if ( classifier != null )
                    {
                        classifier = classifier.substring( 1 );
                    }
                    if ( StringUtils.isEmpty( classifier ) )
                    {
                        classifier = null;
                    }</pre></div></td></tr></table></section>
        </main>
      </div>
    </div>
    <hr/>
    <footer>
      <div class="container-fluid">
        <div class="row-fluid">
            <p>&#169;      2009&#x2013;2022
<a href="https://www.mojohaus.org">MojoHaus</a>
</p>
        </div>
      </div>
    </footer>
<script>
	if(anchors) {
	  anchors.add();
	}
</script>
  </body>
</html>